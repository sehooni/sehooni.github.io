<!DOCTYPE html><!--oAIH0_g3w6LOdbw_0qDiA--><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/chunks/8fa8e9b5e3e9b2cd.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/cbd55ab9639e1e66.js"/><script src="/_next/static/chunks/1abc3924204d7dd0.js" async=""></script><script src="/_next/static/chunks/9c23f44fff36548a.js" async=""></script><script src="/_next/static/chunks/5944084dd90310d5.js" async=""></script><script src="/_next/static/chunks/turbopack-aeaf7046609aeecd.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/_next/static/chunks/a8f82a9835eb887b.js" async=""></script><title>[Proteomics] Peptide Identification - DB Search</title><meta name="description" content="Proteomics 수업 내용 정리 - PeptID_DBSearch"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="antialiased bg-white dark:bg-black text-gray-900 dark:text-white flex min-h-screen"><div hidden=""><!--$--><!--/$--></div><aside class="w-64 h-screen sticky top-0 bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 p-6 overflow-y-auto hidden lg:block"><div class="mb-8"><h1 class="text-2xl font-bold font-sans tracking-tight"><a href="/">Sehoon&#x27;s Workspace</a></h1><p class="text-sm text-gray-500 mt-2">Tech &amp; Study Blog</p></div><nav class="space-y-8"><div><h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">Menu</h3><ul class="space-y-1"><li><a class="block py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors text-sm" href="/">Recent Posts</a></li><li><a class="block py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors text-sm" href="/about/">About</a></li></ul></div><div><h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">Categories</h3><ul class="space-y-1"><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/proteomics/"><span>proteomics</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->9<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/nlp/"><span>NLP</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->6<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/blog/"><span>Blog</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->5<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/jetson/"><span>Jetson</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->4<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/paperreview/"><span>PaperReview</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->4<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/neural_style_transfer/"><span>Neural_Style_Transfer</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->3<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/jekyll/"><span>jekyll</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->2<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/ml/"><span>ML</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->2<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/algorithms/"><span>algorithms</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->1<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/contest/"><span>Contest</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->1<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/capstone/"><span>Capstone</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->1<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/linux/"><span>Linux</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->1<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/etc/"><span>ETC</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->1<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/datastructure/"><span>DataStructure</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->1<!-- -->)</span></a></li><li><a class="flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm" href="/category/dl/"><span>DL</span><span class="text-xs text-gray-400 group-hover:text-blue-500 font-mono">(<!-- -->1<!-- -->)</span></a></li></ul></div></nav><div class="mt-8 pt-8 border-t border-gray-200 dark:border-gray-800"><div class="flex space-x-4"></div></div></aside><main class="flex-1 min-w-0"><div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10"><div class="relative"><article class="prose prose-lg dark:prose-invert max-w-none"><header class="mb-10 not-prose border-b border-gray-100 dark:border-gray-800 pb-8"><div class="mb-4 text-sm text-gray-500 flex items-center space-x-2"><a class="font-medium text-blue-600 hover:underline" href="/category/proteomics/">proteomics</a><span>•</span><time></time></div><h1 class="text-4xl font-extrabold tracking-tight text-gray-900 dark:text-white mb-4">[Proteomics] Peptide Identification - DB Search</h1></header><div><p>이번 시간에는 <strong>“Peptide identification”</strong> 에 대해 이야기해보자. Peptide identification은 서열 밝히기라고 볼 수 있다.</p>
<h1>Outline</h1>
<p>Peptide identification은 크게 3가지 단계로 나뉘어 진다.</p>
<blockquote>
<p><strong>Tandem Mass Spectrometry</strong> → <strong>Peptide Sequencing</strong> → <strong>Database search</strong></p>
</blockquote>
<p>이 중, <strong>DB search</strong>에서 가장 기본이 되는 논문은 <strong>Sequest</strong>이며 추후 논문 리뷰 포스팅에서 다시 한번 이야기 해보도록 하자.</p>
<h1>Proteomic Data Analysis Pipeline</h1>
<p>단백질 데이터 분석의 전체 파이프 라인은 아래의 사진을 통해 쉽게 이해할 수 있다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815575-cb5a9a48-f376-4839-ad68-f0a6ce1f4b7f.png" alt="Untitled"></p>
<p>먼저 샘플을 통해 단백질을 추출한 다음, 효소를 통한 Protein digestion을 진행한다. 이 과정에서 Protein sequence는 peptide sequence로 바뀌게 되며, 이온화 과정을 통해 Mass spectrometry (MS) 정보를 추출하여 MS1, 즉 precursor 이온을 선별하게 된다. 이후, precursor 이온을 Mass spectrometry를 통해 MS2 spectra 정보를 얻고 (이를 어떠한 방법으로 분석하느냐에 따라 분석법이 나뉜다.) 분석을 통해 peptide의 정보를 얻고, 최종적으로 본 단백질이 무엇인가를 판별하게 된다.</p>
<p>단백질 분석 방법을 단계에 따라 나누어 다시한번 이야기해보자. 우리는 다음과 같은 Protein sequence를 분석해야 한다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815499-68c3b9e2-03e8-421d-9f12-0440b2a9b37c.png" alt="Untitled 1"></p>
<h2>Generate Peptides using Specific Enzyme</h2>
<blockquote>
<p>Protein complex → <strong>Enzyme</strong> → Peptides</p>
</blockquote>
<p>특정 효소를 사용하여 protein sequence를 digest 하여 peptide를 형성한다. 본 그림에서는 절단 효소로서 Trypsin이 작용하였다. Trypsin은 K와 R의 C-terminal을 절단한다는 특징을 갖고 있다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815510-4a700a84-bc25-4d51-aa63-7a5d4f74f391.png" alt="Untitled 2"></p>
<h2>Mass spectrum</h2>
<blockquote>
<p>Protein complex → <strong>Enzyme</strong> → Peptides → <strong>Mass spectrometry (MS)</strong> → MS1 spectra</p>
</blockquote>
<p>이후 각 펩타이드의 질량을 분석하게 된다. 이때 측정되는 질량은 <strong>m/z</strong>로 <code>질량/전하량</code> 으로 x축에 위치한다. 무게가 적은 쪽부터 큰 쪽으로 하여 그래프 나타내게 된다. y축은 intensity로 얼마만큼의 펩타이드가 존재하는지를 보여준다.</p>
<p>본 과정은 아래의 그림과 같이 표현할 수 있으며, MS1이 본 과정에 해당한다. 본 과정을 통해 protein을 구성하는 peptide의 종류와 그 크기를 확인할 수 있다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815514-f499ceca-a71e-4d7f-befb-90d4b50874eb.png" alt="Untitled 3"></p>
<h2>Select one peak</h2>
<blockquote>
<p>Protein complex → <strong>Enzyme</strong> → Peptides → <strong>Mass spectrometry (MS)</strong> → MS1 spectra → <strong>Mass spectrometry (collision energy)</strong> → MS2 spectra</p>
</blockquote>
<p>이 중 하나의 peak을 선택하게 되며, 선택된 peak(peptide)는 precursor라고 부르며 이후 과정에 계속 참여하게 된다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815518-b858ecdc-f117-4252-9af1-c0f0c255ce2e.png" alt="Untitled 4"></p>
<h2>Tandem Mass spectrum</h2>
<blockquote>
<p>Protein complex → <strong>Enzyme</strong> → Peptides → <strong>Mass spectrometry (MS)</strong> → MS1 spectra → <strong>Mass spectrometry (collision energy)</strong> → MS2 spectra</p>
</blockquote>
<p>MS1에서 선택된 precursor는 비활성기체와의 충돌을 통해 Energy를 부여 받게 되며, 이온의 형태(precursor ion)로 쪼개지게 된다 <strong>(Fragmentation)</strong>. 이때 side-chain은 그대로 있고 backbone이 잘 끊어지는데, 그러나 이 backbone의 어디가 깨지는지는 모른다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815519-d7ec63cb-45fb-419d-ae8f-8e20acc73bef.png" alt="Untitled 5"></p>
<blockquote>
<p>Protein complex → <strong>Enzyme</strong> → Peptides → <strong>Mass spectrometry (MS)</strong> → MS1 spectra → <strong>Mass spectrometry (collision energy)</strong> → MS2 spectra</p>
</blockquote>
<p>backbone의 어느 부분이 깨지는지 모르기 때문에 모든 경우의 수를 고려한다. <strong>Precursor 이온의 charge에 따라 어느 한 쪽은 이온이, 다른 한 쪽은 이온의 형태가 아닐 수 있으며, 둘 다 이온일 수도 있다.</strong> 또한 peptide sequence에 K나 R이 있으면 이온화에 유리하다. 이 때문에 Trypsin을 사용하는 경우도 있다.</p>
<p>MS부터 MS1 spetra 분석, MS2(collision energy)까지의 과정을 Tandem Mass Spectrometry(MS/MS)라고 부르며 몇가지 특징들이 존재한다.</p>
<ul>
<li>
<p>Tandem Mass Spectrometry (MS/MS) : mainly generates partial N- and C- terminal peptides.</p>
<p><code>Fragmentation이 발생한 부분을 기준으로 앞 부분을 N-term 혹은 prefix</code>라고 부르며, <code>뒷 부분을 C-term 혹은 suffix</code>라고 부른다.</p>
</li>
<li>
<p>Spectrum consists of different ion types because peptides can be broken in several places.</p>
<p>앞에서 이미 언급한 바와 같이, backbone의 어디가 깨지느냐, 즉 어느 고리가 잘릴지 모른다. 어느 쪽이 이온이 될지 모르며, 아미노산의 서열에 따라 잘 깨지는 곳이 존재하지만, 이를 표현하는 계산식은 따로 존재하지 않는다.</p>
</li>
<li>
<p>Chemical noise often complicates the spectrum.</p>
<p>화학적 noise는 spectrum을 복잡하게 할 수 있다. 즉 상당히 민감하다는 것이다. 이러한 노이즈는 외부의 노이즈일 수 있는데, 대표적으로 실험하는 사람의 머리카락 protein인 케라틴, 혹은 internal fragment를 예로 들 수 있다.</p>
</li>
<li>
<p>Represented in 2-D: mass/charge axis vs. intensity axis</p>
<p>2D로 표현되며, MS1에서와 같이 mass/charge (m/z) 축과 intensity 축으로 나타난다.</p>
</li>
</ul>
<p>또한 아래의 그림에 보이는 스펙트럼에서 각 부분의 질량차이는 각 아미노산의 질량을 의미한다고 볼 수 있다. 예시로 주어진 스펙트럼(아래 사진의 노란색 박스)은 비교적 깔끔하고 예쁜 상태이나, 현실에서는 이보다 더 지저분한 스펙트럼이 나오게 된다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815522-c422051c-da2d-494a-99ed-06a3d5c72129.png" alt="Untitled 6"></p>
<p>위 그림은 peptide의 prefix만 표시해 놓은 것이다. Prefix를 쭉 따라 읽으면 forward, suffix를 쭉 따라 읽으면 reversed라고 부른다. 이러한 경우는 이상적인 case로 누가 누군지 유추가 가능하다. 그러나 누가 prefix일지, suffix일지 모르기 때문에, 가정을 통해 유추하게 된다.</p>
<blockquote>
<p>Protein complex → <strong>Enzyme</strong> → Peptides → <strong>Tandem Mass spectrometry (MS/MS) →</strong> MS2 spectra</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/84653623/228815526-7d49f308-ac26-4a48-978c-9d1d2abb7f50.png" alt="Untitled 7"></p>
<p>Tandem Mass Spectrometry에서는 결국 질량차를 통해 구성 아미노산을 유추가능하다. 그렇다면 이렇게 유추한 MS2 spectra를 어떠한 방법을 통해 분석하고, identification하게 될까?</p>
<h1>Peptide identification</h1>
<p>Peptide idenfication에는 크게 두 가지 방법이 존재한다.</p>
<ul>
<li>Database search (Sequest)</li>
<li>de Novo interpretation (Sherenga)</li>
</ul>
<p>DB search가 대체적으로 유용하지만, 조금더 심도 있는 경우 de Novo로 진행되게 된다. 두 방법의 차이는 DB의 유무이다. DB는 reference에 불과하며, 항체와 같이 다른 어느 누군가의 고유의 단백질을 분석하는 경우에는 DB search는 그 효용성을 발휘하지 못한다. 즉, <code>DB가 없는 경우, de Novo interpretation이 더 효과적이다.</code></p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815529-8484ae84-a1bb-45a5-9498-1a4261fc8083.png" alt="Untitled 8"></p>
<h2>Peptide identification</h2>
<p>Peptide identification의 목표는 <code>Find a peptide with maximal match between an experimental and theoretical spectrum.</code> 즉, 이론적인(아주 기본적인) 스펙트럼과 실험적인 스펙트럼 사이의 최대 일치하는 펩타이드를 찾는 것이다.</p>
<p><strong>Input</strong>으로는 4가지가 들어간다.</p>
<ul>
<li><em>S</em> : experimental spectrum</li>
<li><em>△</em> : set of possible ion type</li>
<li><em>m</em> : precursor m/z</li>
<li><em>c</em> : charge</li>
</ul>
<p>△(델타)는 이온이 어디서 깨지는가를 고려하여 input으로 들어가며, c(charge)의 경우 주어지지 않으면 모든 경우의 수를 고려하게 된다. 그러나 보통 MS1에서 c에 대한 값을 제시해준다.</p>
<p>Precursor m/z는 Precursor의 neutral mass와 charge*proton mass의 합을 charge로 나눔으로서 계산하게 된다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228831745-bb4957cb-01d8-4109-85ff-2ddb1d105b85.png" alt="image"></p>
<p>위 식에서 precursor m/z는 관찰값이며, charge * proton mass 부분에서 charge로 1~3가의 이온이 들어갈 수 있다. 또한 여기서 계산된 percursor의 neutral mass와 비슷한 값의 peptide를 찾는 것을 목표로 한다.</p>
<p>이에 따라 <strong>Output</strong>은 <code>A peptide with mass M = ((m - m(H^{+}))*c), whose theoretical spectrum matches the experimental spectrum S best.</code>즉 이론적 스펙트럼이 실험적 스펙트럼 S에 최고로 일치하는 질량 M을 갖는 펩타이드가 나온다.</p>
<p>DB search와 De Novo의 차이를 DB의 유무라고 했는데, 다음 그림을 보면 조금 더 자세히 이해할 수 있다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815531-2bdf920f-b691-434d-9959-384f68a6be31.png" alt="Untitled 9"></p>
<p>즉, DB search는 주어진 DB를 고려하기 때문에 시간복잡도가 10^{8}로 고정되어 있지만, de Novo의 경우 모든 경우의 수를 고려하여 최적의 경로를 찾는 D.P.문제와 같기에 20^{n}의 시간복잡도를 갖게 된다. 이때 질량분석기가 인식할 수 있는 펩타이드의 길이는 아미노산 6개부터 50개가 연결된 경우까지이다.</p>
<h2>Peptide identification by database search</h2>
<p>DB search를 이용한 peptide identification의 목표는 <code>Find a peptide from the database with maximal match between an experimental and a theoretical spectrum.</code>즉, 일반적인 peptide identification과 동일하지만 database로부터 펩타이드를 찾는다는 것에서 차이가 존재한다.</p>
<p>이에 따라 <strong>input</strong>에도 하나가 더 추가된 5가지가 들어간다.</p>
<ul>
<li><em>S</em> : experimental spectrum</li>
<li><strong><em>P</em> : database of peptides</strong></li>
<li><em>△</em> : set of possible ion type</li>
<li><em>m</em> : precursor m/z</li>
<li><em>c</em> : charge</li>
</ul>
<p>이때 △(델타)는 이온 타입에 따라 다 다르며, (b, y)가 major하게 출력된다.</p>
<p>이에 따라 <strong>output</strong> 또한 <code>A peptide of mass M from the database whose theoretical spectrum matches the experimental spectrum S best.</code> 즉, DB로 부터 구해지게 된다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815532-dfbf454b-d69e-4591-9029-df99c5621b94.png" alt="Untitled 10"></p>
<h1>Database</h1>
<p>그렇다면 DB search에서 사용되는 database는 무엇일까? 보통 <strong>UniProtKB</strong>를 많이 사용한다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815534-993adb06-381f-4921-a3b5-380f96a66a41.png" alt="Untitled 11"></p>
<p>UniProtKB는 Swiss-Prot과 TrEMBL구성 되어 있으며, 전문가가 수동적으로 annotation하고 review하였는가 아니면 자동화에 따른 (Automatic) annotation으로 review가 안되었느냐에 따라 구분이 된다. 또한 본 DB는 크게 Human, Bacteria, Virus 등 3가지 category로 분류된다.</p>
<h2>Database - protein</h2>
<p>Protein DB는 <code>.fasta</code>포맷으로 파일이 저장되며, 단백질 시퀀스와 그들의 헤더 정보가 리스트화 되어 저장되어 있다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815536-da587d99-31d8-4a61-8741-e124be5071f9.png" alt="Untitled 12"></p>
<h2>Database - peptide (In silico digestion)</h2>
<p>위와 같은 단백질 시퀀스가 들어오면, 특정 조건에 맞춰서 digestion과정을 반영하여 peptide sequence가  구해진다. 이 과정은 코드로도 구현할 수 있는데 추후 업데이트 할 포스팅에서 코드와 관련한 부분을 다룰 예정이다.</p>
<p>내용만 이야기해보자면, input으로 protein sequence가 들어올 때,  parameter로 <strong>절단 효소와 절단 위치를 이야기하는 Enzyme rule</strong>과 <strong>Number of missed cleavage</strong>, **Enzymic site information(fully, semi, none)**이 주어지게 되며, output으로 peptide sequence와 각 파라미터에 대한 정보가 출력된다. 이러한 과정은 아래의 그림을 통해서 확인이 가능하다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815538-c5904a09-dcf7-47b1-b667-8547002138d2.png" alt="Untitled 13"></p>
<h1>Basics for theoretical spectrum generation</h1>
<p>시퀀싱한 펩타이드 DB를 바탕으로 이론적인 spectrum을 만드는 과정에 대해 알아보자.</p>
<p>Glycine을 예시로 들어 살펴보면 아래의 그림과 같다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815540-de5fd2eb-1756-4876-8d0a-b6843b4ca1db.png" alt="Untitled 14"></p>
<p>Glycine(G)의 경우, 기본적인 backbone인 C_{2}H_{2}NO에 R위치에 H가 붙은 화학 구조를 갖는다. Free amino acid는 G가 단독으로 존재하는 경우를 나타내며, Amino acid residue는 펩타이드에 G가 결합되어 있을 경우를 나타낸다. 이때 전하를 띄지 않는다면 Neutral 상태에 있다고 말할 수 있다. Monoisotopic mass는 단일 동위원소의 질량을 나타내며, 분자 내 각 원자의 가장 풍부한 자연 발생 안정 동위원소의 질량의 합을 취하여 계산이 된다. (이 부분에 대한 설명은 다음다음 사진에서 다시한번 더 다룬다.)</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815542-9811d9ac-41f9-46e8-ad24-71766d02b213.png" alt="Untitled 15"></p>
<p>위의 사진을 보면, 각 아미노산의 residue를 나타내며, 동위원소를 고려한 Avg. mass와 residue mass인 Mono. mass도 같이 포함되어 있다.</p>
<p>이때 Cysteine(C)와 Methionine(M)에서는 질소(N) 대신에 황(S)이 포함되어 있음을 확인할 수 있으며, 그를 제외한 나머지 아미노산들은 탄소(C)와 수소(H), 질소(N)으로 화학식이 구성되어 있음 또한 확인할 수 있다.</p>
<p>다음 그림은 MS1 그래프를 나타낸 것이다. 동위원소의 존재로 인해 다음과 같은 peak들이 여러번 나타나게 되며, 첫 번째 peak이 제일 작은 질량임을 확인할 수 있다. 두 번째 peak은 +1Da, 세 번째 peak은 +2Da, 네 번째 peak은 +3Da일 경우를 나타내며, mono와 다음 peak의 mass 사이의 Da 차이를 통해 charge를 계산할 수 있다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815546-bf407295-2438-4a08-89fd-9948690667bc.png" alt="Untitled 16"></p>
<ul>
<li><strong>Monoisotopic mass</strong> is the mass determined using the masses of the most abundant isotopes.</li>
<li><strong>Average mass</strong> is the abundance weighted mass of all isotopic components.</li>
</ul>
<p>Aver. mass는 탄소 갯수에 따라 질량차(0.x_ or 0._)가 증가하게 됨을 알아두자.</p>
<p>펩타이드가 fragmentation될 때 어디가 잘리느냐에 따라서 부르는 이온의 명칭이 달라진다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815550-a745c622-d1a3-4377-9251-08461b9afd52.png" alt="Untitled 17"></p>
<p>잘린 부분을 기준으로 좌측과 우측은 (a-ion, x-ion), (b-ion, y-ion), (c-ion, z-ion)과 같이 쌍을 이루는 이온의 형태로 존재한다. 이때 각 이온의 아래 첨자는 residue의 갯수를 의미하며, 본인은 C에 결합된 R의 갯수로 생각하면 좋겠다는 생각을 했다. 위에 제시된 그림에서 보이듯이, 빨간 점선의 박스가 아미노산 residue mass를 의미한다.</p>
<p>Mass of a neutral peptide는 residue mass의 합과 terminating group의 mass의 합으로 표현되며, 이때, masses of the terminating groups는 N-terminus의 H와 C-terminus의 OH를 예로 들 수 있다.</p>
<p>아미노산의 residue mass list는 <a href="http://www.matrixscience.com/help/aa_help.html">다음 링크</a>를 통해 보다 자세히 확인할 수 있다.</p>
<h2>E.g. PEP</h2>
<p>PEP를 예시로 하여 mass를 계산하고, 각 이온의 mass, 각 이온의 화학 구조식들, 스펙트럼을 구해보면 다음과 같다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228831800-dbee6844-ff84-46df-9165-23930c268337.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815554-a1521677-60eb-4b57-a2da-77e6ef15679f.png" alt="Untitled 18"></p>
<p>스펙트럼을 살펴보면, <code>y-ion이 상대적으로 mass가 큼</code>을 확인할 수 있다. 특정 fragment ion의 이온화 효율은 화학적 특성, 전하 상태 및 이온화에 사용되는 실험 조건을 비롯한 다양한 요인에 따라 달라질 수 있다. 그 중, y-ion은 일반적으로 peptide fragmentation 중 형성되는 방식 때문에 b-ion보다 상대적으로 무겁게 된다. 이유를 파악하기 위해서는 먼저 y-ion과 b-ion의 형성과정을 이해해야 한다.</p>
<p>y-ion은 펩타이드 결합의 C-terminal을 아미노산의 잔기로 절단하여 형성이 되며, 그 결과 펩타이드의 N-terminal을 포함하는 fragment ion이 생성된다. 이와는 대조적으로, b-ion은 아미노산 잔기에 대한 펩타이드 결합 N-terminal을 절단함으로써 형성이 되며, 그 결과 펩타이드의 C-terminal을 포함하는 fragment ion을 생성한다. <strong>C-terminal에서 N-terminal로 이동함에 따라 peptide backbone의 mass가 증가하기 때문에 peptide의 N-terminal을 포함하는 y-ion은 일반적으로 C-terminal을 포함하는 b-ion보다 무거운 것</strong>이다.</p>
<p>스펙트럼에서 다양한 유형의 fragment ion의 상대적 존재비는 사용된 특정 fragmentation의 방법, peptide 서열 및 다양한 유형의 이온의 ionization 효율을 비록한 다양한 요인에 따라 달라질 수 있다. 일반적으로 collision-induced dissociation(CID) fragmentation에 의해 생성된 스펙트럼에서 y-ion이 b-ion보다 더 풍부한 경향이 있다.</p>
<p>많은 경우에서 Trypsin을 절단효소로 하여 시퀀스의 C-terminal를 절단하기 때문에 그 결과 y이온의 이온화 경우의 수가 많다고 생각할 수 있다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815557-6ec97b34-6a49-43a8-a21a-bdfaaa281443.png" alt="Untitled 19"></p>
<p>각 펩타이드에 대한 스펙트럼을 미리 만들어두면 도움이 되지 않는가라는 생각을 할 수 있다. 그러나 매번 비교하는 DB가 바뀌기 때문에 미리 만들어둔다고 하더라도 쓸모가 없는 경우가 다반수이며, 적용되는 parameter에 따라 스펙트럼은 다르게 나타난다.</p>
<p>위의 첫 번째 그림과 같이 특정 단백질 시퀀스 DB에서 단백질을 불러오면, 절단효소에 따른 Fragment를 구하고, 그 이후 MS/MS Spectrum을 계산하게 되며 이를 통해 실험값에 의한 spectrum과 비교를 하게 된다.</p>
<p>두 번째 그림은 최근 딥러닝 기술의 발전으로 변화된 스펙트럼 예측의 방법을 보여준다. PROSIT의 경우 550,000개의 tryptice peptides와 2,100만개의 high-quality tandem mass specta를 학습시킨 딥러닝 모델로, 미리 데이터를 합성 후 비교를 통해 학습하였다고 알려져있다. 즉, 학습을 위해 dataset을 다시 새로 만들었으며, b-ion과 y-ion의 상대적인 양을 기반으로 위치를 예측한다.</p>
<p>prosit 또한 추후 paper review에서 다룰 예정이다.</p>
<h1>Match between spectra</h1>
<p>그렇다면 실험에 의한 spectrum과 DB에서 구한 spectrum의 비교는 어떻게 이루어질까?</p>
<p>아래의 그림을 보면 Query Spectrum, 즉 실험 spectrum이 주어지면 이를 Spectral Database의 결과와 비교를 통해 결과를 도출한다. 이때 비교하는 방법도 다양하게 존재한다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815559-52640f4c-e95d-46e1-922e-7a4e3fa51a70.png" alt="Untitled 20"></p>
<h2>Match between spectra - SPC</h2>
<p>첫번째로 <strong>SPC, Shared Peak Count</strong>이다. SPC는 두 스펙트럼 사이에서 공유된(동일한) peaks(=masses)의 갯수를 세는 방법이다. ‘# of 공통된 peak’이라고 볼 수 있다.</p>
<ul>
<li>The match between two spectra is the number of masses (peaks) they share <strong>(Shared Peak Count of SPC)</strong></li>
<li>In practice mass-spectrometrists use the weighted SPC that reflects intensities of the peaks</li>
<li>Match between experimental and theoretical spectra is defined similarly</li>
</ul>
<h2>Match between spectra - SEQUEST</h2>
<p>다음으로 SEQUEST이다. SEQUEST는 paper로도 나왔으며, <strong>Cross correlation</strong>방법을 사용하였다는 특징을 갖는다. <strong>Cross correlation</strong>은 두 계열의 유사성을 다른 계열에 대한 한 쪽 변위의 함수로 나타내는 측도를 말하는데, 음 이 표현은 너무 번역한 느낌이 든다.</p>
<p>쉽게 말하자면, 유사한 특징을 갖도록 두 스펙트럼에 푸리에 변환 등과 같은 방법으로 비슷하게 변환하는 것이다. 이 부분이 SEQUEST 논문에서의 핵심이었기 때문에 추후 paper review에서 자세히 다루어보도록 하겠다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815563-2e86a4bd-3337-4671-913c-c072c52e4aca.png" alt="Untitled 21"></p>
<h2>Match between spectra - SEQUEST/Comet</h2>
<p>SEQUEST가 상업화됨에 따라 유사한 방법을 이용하여 만든 tool이 바로 Comet이다. 여기서도 Cross correlation을 통해서 상대적 일치를 평가하고자 하였는데, Auto correlation 부분은 배경 부분이라 Cross correlation에 비해 직접적인 평가를 하지 않는다. Sequest와 Comet 둘다 XCorr 점수를 통해 상대적인 값으로 match(일치)를 평가하게 된다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815565-38c06bf4-98e0-453d-b8d0-472caa715881.png" alt="Untitled 22"></p>
<h2>Match between spectra - X!Tandem score</h2>
<p>또 다른 방법으로 X!Tandem score가 있다. 여기서 관여되는 점수로 <strong>by-score</strong>와 <strong>Hyperscore</strong>가 있다. <code>by-score</code>는 b- 혹은 y-ion의 일치 peaks의 intensities의 합으로 나타나게 되며, <code>Hyperscore</code>는  by-score에 y이온의 갯수!와 b이온의 갯수! 의 곱으로 나타난다. 아래의 그림을 통해 쉽게 이해할 수 있을 것이다. 이러한 점수를 공식화 하면 아래 오른쪽 그림과 같다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815568-14a074bc-2ec4-4490-8731-82b8e5fd25ab.png" alt="Untitled 23"></p>
<p>이러한 점수들을 통해 아래와 같이 ‘Hyperscore-axis’와 ‘# of Matches -axis’ 그래프를 얻을 수 있다. 첫 번째 그래프에서는 비선형적인 양상을 보여 best hot을 계산하기 어렵지만, 두 번째 그래프에서 볼 수 있듯이 ‘# of Matches -axis’에 log를 취하여 주므로써 선형성을 띄도록 만들 수 있다. 이후 Best hit에 해당하는 부분을 구할 수 있게 된다.</p>
<p><img src="https://user-images.githubusercontent.com/84653623/228815572-37925864-9c59-412c-8cc3-c48512f8db8f.png" alt="Untitled 24"></p>
<h1>내용 요약 및 정리</h1>
<p>이번 포스팅에서는 펩타이드의 서열을 밝히는 방법을 중심으로 하여 Tandem Mass Spectrometry[MS/MS]와 peptide sequencing, Database search 기법에 대해 알아보았다.
특히 SEQUEST의 경우 DB search의 가장 기본이, 기초가 되는 논문으로 추후 paper review로 업로드 할 예정이며, Sequest가 상업적인 툴이라면, X!Tandem은 public한 툴로서 그 방법에 대해 알아볼 수 있었다.</p>
<hr>
<blockquote>
<p>본 내용은 한양대학교 컴퓨터소프트웨어학과 및 인공지능학과 백은옥 교수님의 강의자료을 바탕으로하여 작성되었습니다!</p>
</blockquote>
<blockquote>
<p>PS. 추가 문의사항 및 질문은 환영합니다. 그를 통해 저도 더 성장할 수 있을테니까요. :)</p>
</blockquote>
</div></article></div><!--$--><!--/$--></div></main><script src="/_next/static/chunks/cbd55ab9639e1e66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n3:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/8fa8e9b5e3e9b2cd.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"oAIH0-g3w6LOdbw_0qDiA\",\"c\":[\"\",\"posts\",\"2023-03-27-PeptID_DBSearch\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2023-03-27-PeptID_DBSearch\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/8fa8e9b5e3e9b2cd.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased bg-white dark:bg-black text-gray-900 dark:text-white flex min-h-screen\",\"children\":[\"$L2\",[\"$\",\"main\",null,{\"className\":\"flex-1 min-w-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/a8f82a9835eb887b.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[22016,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/a8f82a9835eb887b.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"2:[\"$\",\"aside\",null,{\"className\":\"w-64 h-screen sticky top-0 bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 p-6 overflow-y-auto hidden lg:block\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-2xl font-bold font-sans tracking-tight\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/\",\"children\":\"Sehoon's Workspace\"}]}],[\"$\",\"p\",null,{\"className\":\"text-sm text-gray-500 mt-2\",\"children\":\"Tech \u0026 Study Blog\"}]]}],[\"$\",\"nav\",null,{\"className\":\"space-y-8\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2\",\"children\":\"Menu\"}],[\"$\",\"ul\",null,{\"className\":\"space-y-1\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"block py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors text-sm\",\"children\":\"Recent Posts\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/about\",\"className\":\"block py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors text-sm\",\"children\":\"About\"}]}]]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2\",\"children\":\"Categories\"}],[\"$\",\"ul\",null,{\"className\":\"space-y-1\",\"children\":[[\"$\",\"li\",\"proteomics\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/proteomics\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"proteomics\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",9,\")\"]}]]}]}],[\"$\",\"li\",\"NLP\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/nlp\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"NLP\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",6,\")\"]}]]}]}],[\"$\",\"li\",\"Blog\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/blog\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Blog\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",5,\")\"]}]]}]}],[\"$\",\"li\",\"Jetson\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/jetson\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Jetson\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",4,\")\"]}]]}]}],[\"$\",\"li\",\"PaperReview\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/paperreview\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"PaperReview\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",4,\")\"]}]]}]}],[\"$\",\"li\",\"Neural_Style_Transfer\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/neural_style_transfer\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Neural_Style_Transfer\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",3,\")\"]}]]}]}],[\"$\",\"li\",\"jekyll\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/jekyll\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"jekyll\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",2,\")\"]}]]}]}],[\"$\",\"li\",\"ML\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/ml\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[\"$Lf\",\"$L10\"]}]}],\"$L11\",\"$L12\",\"$L13\",\"$L14\",\"$L15\",\"$L16\",\"$L17\"]}]]}]]}],\"$L18\"]}]\n"])</script><script>self.__next_f.push([1,"f:[\"$\",\"span\",null,{\"children\":\"ML\"}]\n10:[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",2,\")\"]}]\n11:[\"$\",\"li\",\"algorithms\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/algorithms\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"algorithms\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",1,\")\"]}]]}]}]\n12:[\"$\",\"li\",\"Contest\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/contest\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Contest\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",1,\")\"]}]]}]}]\n13:[\"$\",\"li\",\"Capstone\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/capstone\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Capstone\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",1,\")\"]}]]}]}]\n14:[\"$\",\"li\",\"Linux\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/linux\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"Linux\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",1,\")\"]}]]}]}]\n15:[\"$\",\"li\",\"ETC\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/etc\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"ETC\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",1,\")\"]}]]}]}]\n16:[\"$\",\"li\",\"DataStructure\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/datastructure\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"DataStructure\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",1,\")\"]}]]}]}]\n17:[\"$\",\"li\",\"DL\",{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/category/dl\",\"className\":\"flex items-center justify-between py-1.5 text-gray-700 dark:text-gray-300 hover:text-blue-600 transition-colors group text-sm\",\"children\":[[\"$\",\"span\",null,{\"children\":\"DL\"}],[\"$\",\"span\",null,{\"className\":\"text-xs text-gray-400 group-hover:text-blue-500 font-mono\",\"children\":[\"(\",1,\")\"]}]]}]}]\n18:[\"$\",\"div\",null,{\"className\":\"mt-8 pt-8 border-t border-gray-200 dark:border-gray-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex space-x-4\"}]}]\n"])</script><script>self.__next_f.push([1,"19:T64b0,"])</script><script>self.__next_f.push([1,"\u003cp\u003e이번 시간에는 \u003cstrong\u003e“Peptide identification”\u003c/strong\u003e 에 대해 이야기해보자. Peptide identification은 서열 밝히기라고 볼 수 있다.\u003c/p\u003e\n\u003ch1\u003eOutline\u003c/h1\u003e\n\u003cp\u003ePeptide identification은 크게 3가지 단계로 나뉘어 진다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eTandem Mass Spectrometry\u003c/strong\u003e → \u003cstrong\u003ePeptide Sequencing\u003c/strong\u003e → \u003cstrong\u003eDatabase search\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e이 중, \u003cstrong\u003eDB search\u003c/strong\u003e에서 가장 기본이 되는 논문은 \u003cstrong\u003eSequest\u003c/strong\u003e이며 추후 논문 리뷰 포스팅에서 다시 한번 이야기 해보도록 하자.\u003c/p\u003e\n\u003ch1\u003eProteomic Data Analysis Pipeline\u003c/h1\u003e\n\u003cp\u003e단백질 데이터 분석의 전체 파이프 라인은 아래의 사진을 통해 쉽게 이해할 수 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815575-cb5a9a48-f376-4839-ad68-f0a6ce1f4b7f.png\" alt=\"Untitled\"\u003e\u003c/p\u003e\n\u003cp\u003e먼저 샘플을 통해 단백질을 추출한 다음, 효소를 통한 Protein digestion을 진행한다. 이 과정에서 Protein sequence는 peptide sequence로 바뀌게 되며, 이온화 과정을 통해 Mass spectrometry (MS) 정보를 추출하여 MS1, 즉 precursor 이온을 선별하게 된다. 이후, precursor 이온을 Mass spectrometry를 통해 MS2 spectra 정보를 얻고 (이를 어떠한 방법으로 분석하느냐에 따라 분석법이 나뉜다.) 분석을 통해 peptide의 정보를 얻고, 최종적으로 본 단백질이 무엇인가를 판별하게 된다.\u003c/p\u003e\n\u003cp\u003e단백질 분석 방법을 단계에 따라 나누어 다시한번 이야기해보자. 우리는 다음과 같은 Protein sequence를 분석해야 한다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815499-68c3b9e2-03e8-421d-9f12-0440b2a9b37c.png\" alt=\"Untitled 1\"\u003e\u003c/p\u003e\n\u003ch2\u003eGenerate Peptides using Specific Enzyme\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eProtein complex → \u003cstrong\u003eEnzyme\u003c/strong\u003e → Peptides\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e특정 효소를 사용하여 protein sequence를 digest 하여 peptide를 형성한다. 본 그림에서는 절단 효소로서 Trypsin이 작용하였다. Trypsin은 K와 R의 C-terminal을 절단한다는 특징을 갖고 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815510-4a700a84-bc25-4d51-aa63-7a5d4f74f391.png\" alt=\"Untitled 2\"\u003e\u003c/p\u003e\n\u003ch2\u003eMass spectrum\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eProtein complex → \u003cstrong\u003eEnzyme\u003c/strong\u003e → Peptides → \u003cstrong\u003eMass spectrometry (MS)\u003c/strong\u003e → MS1 spectra\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e이후 각 펩타이드의 질량을 분석하게 된다. 이때 측정되는 질량은 \u003cstrong\u003em/z\u003c/strong\u003e로 \u003ccode\u003e질량/전하량\u003c/code\u003e 으로 x축에 위치한다. 무게가 적은 쪽부터 큰 쪽으로 하여 그래프 나타내게 된다. y축은 intensity로 얼마만큼의 펩타이드가 존재하는지를 보여준다.\u003c/p\u003e\n\u003cp\u003e본 과정은 아래의 그림과 같이 표현할 수 있으며, MS1이 본 과정에 해당한다. 본 과정을 통해 protein을 구성하는 peptide의 종류와 그 크기를 확인할 수 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815514-f499ceca-a71e-4d7f-befb-90d4b50874eb.png\" alt=\"Untitled 3\"\u003e\u003c/p\u003e\n\u003ch2\u003eSelect one peak\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eProtein complex → \u003cstrong\u003eEnzyme\u003c/strong\u003e → Peptides → \u003cstrong\u003eMass spectrometry (MS)\u003c/strong\u003e → MS1 spectra → \u003cstrong\u003eMass spectrometry (collision energy)\u003c/strong\u003e → MS2 spectra\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e이 중 하나의 peak을 선택하게 되며, 선택된 peak(peptide)는 precursor라고 부르며 이후 과정에 계속 참여하게 된다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815518-b858ecdc-f117-4252-9af1-c0f0c255ce2e.png\" alt=\"Untitled 4\"\u003e\u003c/p\u003e\n\u003ch2\u003eTandem Mass spectrum\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eProtein complex → \u003cstrong\u003eEnzyme\u003c/strong\u003e → Peptides → \u003cstrong\u003eMass spectrometry (MS)\u003c/strong\u003e → MS1 spectra → \u003cstrong\u003eMass spectrometry (collision energy)\u003c/strong\u003e → MS2 spectra\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eMS1에서 선택된 precursor는 비활성기체와의 충돌을 통해 Energy를 부여 받게 되며, 이온의 형태(precursor ion)로 쪼개지게 된다 \u003cstrong\u003e(Fragmentation)\u003c/strong\u003e. 이때 side-chain은 그대로 있고 backbone이 잘 끊어지는데, 그러나 이 backbone의 어디가 깨지는지는 모른다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815519-d7ec63cb-45fb-419d-ae8f-8e20acc73bef.png\" alt=\"Untitled 5\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eProtein complex → \u003cstrong\u003eEnzyme\u003c/strong\u003e → Peptides → \u003cstrong\u003eMass spectrometry (MS)\u003c/strong\u003e → MS1 spectra → \u003cstrong\u003eMass spectrometry (collision energy)\u003c/strong\u003e → MS2 spectra\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003ebackbone의 어느 부분이 깨지는지 모르기 때문에 모든 경우의 수를 고려한다. \u003cstrong\u003ePrecursor 이온의 charge에 따라 어느 한 쪽은 이온이, 다른 한 쪽은 이온의 형태가 아닐 수 있으며, 둘 다 이온일 수도 있다.\u003c/strong\u003e 또한 peptide sequence에 K나 R이 있으면 이온화에 유리하다. 이 때문에 Trypsin을 사용하는 경우도 있다.\u003c/p\u003e\n\u003cp\u003eMS부터 MS1 spetra 분석, MS2(collision energy)까지의 과정을 Tandem Mass Spectrometry(MS/MS)라고 부르며 몇가지 특징들이 존재한다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTandem Mass Spectrometry (MS/MS) : mainly generates partial N- and C- terminal peptides.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eFragmentation이 발생한 부분을 기준으로 앞 부분을 N-term 혹은 prefix\u003c/code\u003e라고 부르며, \u003ccode\u003e뒷 부분을 C-term 혹은 suffix\u003c/code\u003e라고 부른다.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSpectrum consists of different ion types because peptides can be broken in several places.\u003c/p\u003e\n\u003cp\u003e앞에서 이미 언급한 바와 같이, backbone의 어디가 깨지느냐, 즉 어느 고리가 잘릴지 모른다. 어느 쪽이 이온이 될지 모르며, 아미노산의 서열에 따라 잘 깨지는 곳이 존재하지만, 이를 표현하는 계산식은 따로 존재하지 않는다.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eChemical noise often complicates the spectrum.\u003c/p\u003e\n\u003cp\u003e화학적 noise는 spectrum을 복잡하게 할 수 있다. 즉 상당히 민감하다는 것이다. 이러한 노이즈는 외부의 노이즈일 수 있는데, 대표적으로 실험하는 사람의 머리카락 protein인 케라틴, 혹은 internal fragment를 예로 들 수 있다.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRepresented in 2-D: mass/charge axis vs. intensity axis\u003c/p\u003e\n\u003cp\u003e2D로 표현되며, MS1에서와 같이 mass/charge (m/z) 축과 intensity 축으로 나타난다.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e또한 아래의 그림에 보이는 스펙트럼에서 각 부분의 질량차이는 각 아미노산의 질량을 의미한다고 볼 수 있다. 예시로 주어진 스펙트럼(아래 사진의 노란색 박스)은 비교적 깔끔하고 예쁜 상태이나, 현실에서는 이보다 더 지저분한 스펙트럼이 나오게 된다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815522-c422051c-da2d-494a-99ed-06a3d5c72129.png\" alt=\"Untitled 6\"\u003e\u003c/p\u003e\n\u003cp\u003e위 그림은 peptide의 prefix만 표시해 놓은 것이다. Prefix를 쭉 따라 읽으면 forward, suffix를 쭉 따라 읽으면 reversed라고 부른다. 이러한 경우는 이상적인 case로 누가 누군지 유추가 가능하다. 그러나 누가 prefix일지, suffix일지 모르기 때문에, 가정을 통해 유추하게 된다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eProtein complex → \u003cstrong\u003eEnzyme\u003c/strong\u003e → Peptides → \u003cstrong\u003eTandem Mass spectrometry (MS/MS) →\u003c/strong\u003e MS2 spectra\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815526-7d49f308-ac26-4a48-978c-9d1d2abb7f50.png\" alt=\"Untitled 7\"\u003e\u003c/p\u003e\n\u003cp\u003eTandem Mass Spectrometry에서는 결국 질량차를 통해 구성 아미노산을 유추가능하다. 그렇다면 이렇게 유추한 MS2 spectra를 어떠한 방법을 통해 분석하고, identification하게 될까?\u003c/p\u003e\n\u003ch1\u003ePeptide identification\u003c/h1\u003e\n\u003cp\u003ePeptide idenfication에는 크게 두 가지 방법이 존재한다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDatabase search (Sequest)\u003c/li\u003e\n\u003cli\u003ede Novo interpretation (Sherenga)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eDB search가 대체적으로 유용하지만, 조금더 심도 있는 경우 de Novo로 진행되게 된다. 두 방법의 차이는 DB의 유무이다. DB는 reference에 불과하며, 항체와 같이 다른 어느 누군가의 고유의 단백질을 분석하는 경우에는 DB search는 그 효용성을 발휘하지 못한다. 즉, \u003ccode\u003eDB가 없는 경우, de Novo interpretation이 더 효과적이다.\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815529-8484ae84-a1bb-45a5-9498-1a4261fc8083.png\" alt=\"Untitled 8\"\u003e\u003c/p\u003e\n\u003ch2\u003ePeptide identification\u003c/h2\u003e\n\u003cp\u003ePeptide identification의 목표는 \u003ccode\u003eFind a peptide with maximal match between an experimental and theoretical spectrum.\u003c/code\u003e 즉, 이론적인(아주 기본적인) 스펙트럼과 실험적인 스펙트럼 사이의 최대 일치하는 펩타이드를 찾는 것이다.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eInput\u003c/strong\u003e으로는 4가지가 들어간다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eS\u003c/em\u003e : experimental spectrum\u003c/li\u003e\n\u003cli\u003e\u003cem\u003e△\u003c/em\u003e : set of possible ion type\u003c/li\u003e\n\u003cli\u003e\u003cem\u003em\u003c/em\u003e : precursor m/z\u003c/li\u003e\n\u003cli\u003e\u003cem\u003ec\u003c/em\u003e : charge\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e△(델타)는 이온이 어디서 깨지는가를 고려하여 input으로 들어가며, c(charge)의 경우 주어지지 않으면 모든 경우의 수를 고려하게 된다. 그러나 보통 MS1에서 c에 대한 값을 제시해준다.\u003c/p\u003e\n\u003cp\u003ePrecursor m/z는 Precursor의 neutral mass와 charge*proton mass의 합을 charge로 나눔으로서 계산하게 된다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228831745-bb4957cb-01d8-4109-85ff-2ddb1d105b85.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e위 식에서 precursor m/z는 관찰값이며, charge * proton mass 부분에서 charge로 1~3가의 이온이 들어갈 수 있다. 또한 여기서 계산된 percursor의 neutral mass와 비슷한 값의 peptide를 찾는 것을 목표로 한다.\u003c/p\u003e\n\u003cp\u003e이에 따라 \u003cstrong\u003eOutput\u003c/strong\u003e은 \u003ccode\u003eA peptide with mass M = ((m - m(H^{+}))*c), whose theoretical spectrum matches the experimental spectrum S best.\u003c/code\u003e즉 이론적 스펙트럼이 실험적 스펙트럼 S에 최고로 일치하는 질량 M을 갖는 펩타이드가 나온다.\u003c/p\u003e\n\u003cp\u003eDB search와 De Novo의 차이를 DB의 유무라고 했는데, 다음 그림을 보면 조금 더 자세히 이해할 수 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815531-2bdf920f-b691-434d-9959-384f68a6be31.png\" alt=\"Untitled 9\"\u003e\u003c/p\u003e\n\u003cp\u003e즉, DB search는 주어진 DB를 고려하기 때문에 시간복잡도가 10^{8}로 고정되어 있지만, de Novo의 경우 모든 경우의 수를 고려하여 최적의 경로를 찾는 D.P.문제와 같기에 20^{n}의 시간복잡도를 갖게 된다. 이때 질량분석기가 인식할 수 있는 펩타이드의 길이는 아미노산 6개부터 50개가 연결된 경우까지이다.\u003c/p\u003e\n\u003ch2\u003ePeptide identification by database search\u003c/h2\u003e\n\u003cp\u003eDB search를 이용한 peptide identification의 목표는 \u003ccode\u003eFind a peptide from the database with maximal match between an experimental and a theoretical spectrum.\u003c/code\u003e즉, 일반적인 peptide identification과 동일하지만 database로부터 펩타이드를 찾는다는 것에서 차이가 존재한다.\u003c/p\u003e\n\u003cp\u003e이에 따라 \u003cstrong\u003einput\u003c/strong\u003e에도 하나가 더 추가된 5가지가 들어간다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eS\u003c/em\u003e : experimental spectrum\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003eP\u003c/em\u003e : database of peptides\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cem\u003e△\u003c/em\u003e : set of possible ion type\u003c/li\u003e\n\u003cli\u003e\u003cem\u003em\u003c/em\u003e : precursor m/z\u003c/li\u003e\n\u003cli\u003e\u003cem\u003ec\u003c/em\u003e : charge\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이때 △(델타)는 이온 타입에 따라 다 다르며, (b, y)가 major하게 출력된다.\u003c/p\u003e\n\u003cp\u003e이에 따라 \u003cstrong\u003eoutput\u003c/strong\u003e 또한 \u003ccode\u003eA peptide of mass M from the database whose theoretical spectrum matches the experimental spectrum S best.\u003c/code\u003e 즉, DB로 부터 구해지게 된다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815532-dfbf454b-d69e-4591-9029-df99c5621b94.png\" alt=\"Untitled 10\"\u003e\u003c/p\u003e\n\u003ch1\u003eDatabase\u003c/h1\u003e\n\u003cp\u003e그렇다면 DB search에서 사용되는 database는 무엇일까? 보통 \u003cstrong\u003eUniProtKB\u003c/strong\u003e를 많이 사용한다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815534-993adb06-381f-4921-a3b5-380f96a66a41.png\" alt=\"Untitled 11\"\u003e\u003c/p\u003e\n\u003cp\u003eUniProtKB는 Swiss-Prot과 TrEMBL구성 되어 있으며, 전문가가 수동적으로 annotation하고 review하였는가 아니면 자동화에 따른 (Automatic) annotation으로 review가 안되었느냐에 따라 구분이 된다. 또한 본 DB는 크게 Human, Bacteria, Virus 등 3가지 category로 분류된다.\u003c/p\u003e\n\u003ch2\u003eDatabase - protein\u003c/h2\u003e\n\u003cp\u003eProtein DB는 \u003ccode\u003e.fasta\u003c/code\u003e포맷으로 파일이 저장되며, 단백질 시퀀스와 그들의 헤더 정보가 리스트화 되어 저장되어 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815536-da587d99-31d8-4a61-8741-e124be5071f9.png\" alt=\"Untitled 12\"\u003e\u003c/p\u003e\n\u003ch2\u003eDatabase - peptide (In silico digestion)\u003c/h2\u003e\n\u003cp\u003e위와 같은 단백질 시퀀스가 들어오면, 특정 조건에 맞춰서 digestion과정을 반영하여 peptide sequence가  구해진다. 이 과정은 코드로도 구현할 수 있는데 추후 업데이트 할 포스팅에서 코드와 관련한 부분을 다룰 예정이다.\u003c/p\u003e\n\u003cp\u003e내용만 이야기해보자면, input으로 protein sequence가 들어올 때,  parameter로 \u003cstrong\u003e절단 효소와 절단 위치를 이야기하는 Enzyme rule\u003c/strong\u003e과 \u003cstrong\u003eNumber of missed cleavage\u003c/strong\u003e, **Enzymic site information(fully, semi, none)**이 주어지게 되며, output으로 peptide sequence와 각 파라미터에 대한 정보가 출력된다. 이러한 과정은 아래의 그림을 통해서 확인이 가능하다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815538-c5904a09-dcf7-47b1-b667-8547002138d2.png\" alt=\"Untitled 13\"\u003e\u003c/p\u003e\n\u003ch1\u003eBasics for theoretical spectrum generation\u003c/h1\u003e\n\u003cp\u003e시퀀싱한 펩타이드 DB를 바탕으로 이론적인 spectrum을 만드는 과정에 대해 알아보자.\u003c/p\u003e\n\u003cp\u003eGlycine을 예시로 들어 살펴보면 아래의 그림과 같다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815540-de5fd2eb-1756-4876-8d0a-b6843b4ca1db.png\" alt=\"Untitled 14\"\u003e\u003c/p\u003e\n\u003cp\u003eGlycine(G)의 경우, 기본적인 backbone인 C_{2}H_{2}NO에 R위치에 H가 붙은 화학 구조를 갖는다. Free amino acid는 G가 단독으로 존재하는 경우를 나타내며, Amino acid residue는 펩타이드에 G가 결합되어 있을 경우를 나타낸다. 이때 전하를 띄지 않는다면 Neutral 상태에 있다고 말할 수 있다. Monoisotopic mass는 단일 동위원소의 질량을 나타내며, 분자 내 각 원자의 가장 풍부한 자연 발생 안정 동위원소의 질량의 합을 취하여 계산이 된다. (이 부분에 대한 설명은 다음다음 사진에서 다시한번 더 다룬다.)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815542-9811d9ac-41f9-46e8-ad24-71766d02b213.png\" alt=\"Untitled 15\"\u003e\u003c/p\u003e\n\u003cp\u003e위의 사진을 보면, 각 아미노산의 residue를 나타내며, 동위원소를 고려한 Avg. mass와 residue mass인 Mono. mass도 같이 포함되어 있다.\u003c/p\u003e\n\u003cp\u003e이때 Cysteine(C)와 Methionine(M)에서는 질소(N) 대신에 황(S)이 포함되어 있음을 확인할 수 있으며, 그를 제외한 나머지 아미노산들은 탄소(C)와 수소(H), 질소(N)으로 화학식이 구성되어 있음 또한 확인할 수 있다.\u003c/p\u003e\n\u003cp\u003e다음 그림은 MS1 그래프를 나타낸 것이다. 동위원소의 존재로 인해 다음과 같은 peak들이 여러번 나타나게 되며, 첫 번째 peak이 제일 작은 질량임을 확인할 수 있다. 두 번째 peak은 +1Da, 세 번째 peak은 +2Da, 네 번째 peak은 +3Da일 경우를 나타내며, mono와 다음 peak의 mass 사이의 Da 차이를 통해 charge를 계산할 수 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815546-bf407295-2438-4a08-89fd-9948690667bc.png\" alt=\"Untitled 16\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eMonoisotopic mass\u003c/strong\u003e is the mass determined using the masses of the most abundant isotopes.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAverage mass\u003c/strong\u003e is the abundance weighted mass of all isotopic components.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAver. mass는 탄소 갯수에 따라 질량차(0.x_ or 0._)가 증가하게 됨을 알아두자.\u003c/p\u003e\n\u003cp\u003e펩타이드가 fragmentation될 때 어디가 잘리느냐에 따라서 부르는 이온의 명칭이 달라진다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815550-a745c622-d1a3-4377-9251-08461b9afd52.png\" alt=\"Untitled 17\"\u003e\u003c/p\u003e\n\u003cp\u003e잘린 부분을 기준으로 좌측과 우측은 (a-ion, x-ion), (b-ion, y-ion), (c-ion, z-ion)과 같이 쌍을 이루는 이온의 형태로 존재한다. 이때 각 이온의 아래 첨자는 residue의 갯수를 의미하며, 본인은 C에 결합된 R의 갯수로 생각하면 좋겠다는 생각을 했다. 위에 제시된 그림에서 보이듯이, 빨간 점선의 박스가 아미노산 residue mass를 의미한다.\u003c/p\u003e\n\u003cp\u003eMass of a neutral peptide는 residue mass의 합과 terminating group의 mass의 합으로 표현되며, 이때, masses of the terminating groups는 N-terminus의 H와 C-terminus의 OH를 예로 들 수 있다.\u003c/p\u003e\n\u003cp\u003e아미노산의 residue mass list는 \u003ca href=\"http://www.matrixscience.com/help/aa_help.html\"\u003e다음 링크\u003c/a\u003e를 통해 보다 자세히 확인할 수 있다.\u003c/p\u003e\n\u003ch2\u003eE.g. PEP\u003c/h2\u003e\n\u003cp\u003ePEP를 예시로 하여 mass를 계산하고, 각 이온의 mass, 각 이온의 화학 구조식들, 스펙트럼을 구해보면 다음과 같다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228831800-dbee6844-ff84-46df-9165-23930c268337.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815554-a1521677-60eb-4b57-a2da-77e6ef15679f.png\" alt=\"Untitled 18\"\u003e\u003c/p\u003e\n\u003cp\u003e스펙트럼을 살펴보면, \u003ccode\u003ey-ion이 상대적으로 mass가 큼\u003c/code\u003e을 확인할 수 있다. 특정 fragment ion의 이온화 효율은 화학적 특성, 전하 상태 및 이온화에 사용되는 실험 조건을 비롯한 다양한 요인에 따라 달라질 수 있다. 그 중, y-ion은 일반적으로 peptide fragmentation 중 형성되는 방식 때문에 b-ion보다 상대적으로 무겁게 된다. 이유를 파악하기 위해서는 먼저 y-ion과 b-ion의 형성과정을 이해해야 한다.\u003c/p\u003e\n\u003cp\u003ey-ion은 펩타이드 결합의 C-terminal을 아미노산의 잔기로 절단하여 형성이 되며, 그 결과 펩타이드의 N-terminal을 포함하는 fragment ion이 생성된다. 이와는 대조적으로, b-ion은 아미노산 잔기에 대한 펩타이드 결합 N-terminal을 절단함으로써 형성이 되며, 그 결과 펩타이드의 C-terminal을 포함하는 fragment ion을 생성한다. \u003cstrong\u003eC-terminal에서 N-terminal로 이동함에 따라 peptide backbone의 mass가 증가하기 때문에 peptide의 N-terminal을 포함하는 y-ion은 일반적으로 C-terminal을 포함하는 b-ion보다 무거운 것\u003c/strong\u003e이다.\u003c/p\u003e\n\u003cp\u003e스펙트럼에서 다양한 유형의 fragment ion의 상대적 존재비는 사용된 특정 fragmentation의 방법, peptide 서열 및 다양한 유형의 이온의 ionization 효율을 비록한 다양한 요인에 따라 달라질 수 있다. 일반적으로 collision-induced dissociation(CID) fragmentation에 의해 생성된 스펙트럼에서 y-ion이 b-ion보다 더 풍부한 경향이 있다.\u003c/p\u003e\n\u003cp\u003e많은 경우에서 Trypsin을 절단효소로 하여 시퀀스의 C-terminal를 절단하기 때문에 그 결과 y이온의 이온화 경우의 수가 많다고 생각할 수 있다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815557-6ec97b34-6a49-43a8-a21a-bdfaaa281443.png\" alt=\"Untitled 19\"\u003e\u003c/p\u003e\n\u003cp\u003e각 펩타이드에 대한 스펙트럼을 미리 만들어두면 도움이 되지 않는가라는 생각을 할 수 있다. 그러나 매번 비교하는 DB가 바뀌기 때문에 미리 만들어둔다고 하더라도 쓸모가 없는 경우가 다반수이며, 적용되는 parameter에 따라 스펙트럼은 다르게 나타난다.\u003c/p\u003e\n\u003cp\u003e위의 첫 번째 그림과 같이 특정 단백질 시퀀스 DB에서 단백질을 불러오면, 절단효소에 따른 Fragment를 구하고, 그 이후 MS/MS Spectrum을 계산하게 되며 이를 통해 실험값에 의한 spectrum과 비교를 하게 된다.\u003c/p\u003e\n\u003cp\u003e두 번째 그림은 최근 딥러닝 기술의 발전으로 변화된 스펙트럼 예측의 방법을 보여준다. PROSIT의 경우 550,000개의 tryptice peptides와 2,100만개의 high-quality tandem mass specta를 학습시킨 딥러닝 모델로, 미리 데이터를 합성 후 비교를 통해 학습하였다고 알려져있다. 즉, 학습을 위해 dataset을 다시 새로 만들었으며, b-ion과 y-ion의 상대적인 양을 기반으로 위치를 예측한다.\u003c/p\u003e\n\u003cp\u003eprosit 또한 추후 paper review에서 다룰 예정이다.\u003c/p\u003e\n\u003ch1\u003eMatch between spectra\u003c/h1\u003e\n\u003cp\u003e그렇다면 실험에 의한 spectrum과 DB에서 구한 spectrum의 비교는 어떻게 이루어질까?\u003c/p\u003e\n\u003cp\u003e아래의 그림을 보면 Query Spectrum, 즉 실험 spectrum이 주어지면 이를 Spectral Database의 결과와 비교를 통해 결과를 도출한다. 이때 비교하는 방법도 다양하게 존재한다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815559-52640f4c-e95d-46e1-922e-7a4e3fa51a70.png\" alt=\"Untitled 20\"\u003e\u003c/p\u003e\n\u003ch2\u003eMatch between spectra - SPC\u003c/h2\u003e\n\u003cp\u003e첫번째로 \u003cstrong\u003eSPC, Shared Peak Count\u003c/strong\u003e이다. SPC는 두 스펙트럼 사이에서 공유된(동일한) peaks(=masses)의 갯수를 세는 방법이다. ‘# of 공통된 peak’이라고 볼 수 있다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe match between two spectra is the number of masses (peaks) they share \u003cstrong\u003e(Shared Peak Count of SPC)\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eIn practice mass-spectrometrists use the weighted SPC that reflects intensities of the peaks\u003c/li\u003e\n\u003cli\u003eMatch between experimental and theoretical spectra is defined similarly\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eMatch between spectra - SEQUEST\u003c/h2\u003e\n\u003cp\u003e다음으로 SEQUEST이다. SEQUEST는 paper로도 나왔으며, \u003cstrong\u003eCross correlation\u003c/strong\u003e방법을 사용하였다는 특징을 갖는다. \u003cstrong\u003eCross correlation\u003c/strong\u003e은 두 계열의 유사성을 다른 계열에 대한 한 쪽 변위의 함수로 나타내는 측도를 말하는데, 음 이 표현은 너무 번역한 느낌이 든다.\u003c/p\u003e\n\u003cp\u003e쉽게 말하자면, 유사한 특징을 갖도록 두 스펙트럼에 푸리에 변환 등과 같은 방법으로 비슷하게 변환하는 것이다. 이 부분이 SEQUEST 논문에서의 핵심이었기 때문에 추후 paper review에서 자세히 다루어보도록 하겠다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815563-2e86a4bd-3337-4671-913c-c072c52e4aca.png\" alt=\"Untitled 21\"\u003e\u003c/p\u003e\n\u003ch2\u003eMatch between spectra - SEQUEST/Comet\u003c/h2\u003e\n\u003cp\u003eSEQUEST가 상업화됨에 따라 유사한 방법을 이용하여 만든 tool이 바로 Comet이다. 여기서도 Cross correlation을 통해서 상대적 일치를 평가하고자 하였는데, Auto correlation 부분은 배경 부분이라 Cross correlation에 비해 직접적인 평가를 하지 않는다. Sequest와 Comet 둘다 XCorr 점수를 통해 상대적인 값으로 match(일치)를 평가하게 된다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815565-38c06bf4-98e0-453d-b8d0-472caa715881.png\" alt=\"Untitled 22\"\u003e\u003c/p\u003e\n\u003ch2\u003eMatch between spectra - X!Tandem score\u003c/h2\u003e\n\u003cp\u003e또 다른 방법으로 X!Tandem score가 있다. 여기서 관여되는 점수로 \u003cstrong\u003eby-score\u003c/strong\u003e와 \u003cstrong\u003eHyperscore\u003c/strong\u003e가 있다. \u003ccode\u003eby-score\u003c/code\u003e는 b- 혹은 y-ion의 일치 peaks의 intensities의 합으로 나타나게 되며, \u003ccode\u003eHyperscore\u003c/code\u003e는  by-score에 y이온의 갯수!와 b이온의 갯수! 의 곱으로 나타난다. 아래의 그림을 통해 쉽게 이해할 수 있을 것이다. 이러한 점수를 공식화 하면 아래 오른쪽 그림과 같다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815568-14a074bc-2ec4-4490-8731-82b8e5fd25ab.png\" alt=\"Untitled 23\"\u003e\u003c/p\u003e\n\u003cp\u003e이러한 점수들을 통해 아래와 같이 ‘Hyperscore-axis’와 ‘# of Matches -axis’ 그래프를 얻을 수 있다. 첫 번째 그래프에서는 비선형적인 양상을 보여 best hot을 계산하기 어렵지만, 두 번째 그래프에서 볼 수 있듯이 ‘# of Matches -axis’에 log를 취하여 주므로써 선형성을 띄도록 만들 수 있다. 이후 Best hit에 해당하는 부분을 구할 수 있게 된다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/84653623/228815572-37925864-9c59-412c-8cc3-c48512f8db8f.png\" alt=\"Untitled 24\"\u003e\u003c/p\u003e\n\u003ch1\u003e내용 요약 및 정리\u003c/h1\u003e\n\u003cp\u003e이번 포스팅에서는 펩타이드의 서열을 밝히는 방법을 중심으로 하여 Tandem Mass Spectrometry[MS/MS]와 peptide sequencing, Database search 기법에 대해 알아보았다.\n특히 SEQUEST의 경우 DB search의 가장 기본이, 기초가 되는 논문으로 추후 paper review로 업로드 할 예정이며, Sequest가 상업적인 툴이라면, X!Tandem은 public한 툴로서 그 방법에 대해 알아볼 수 있었다.\u003c/p\u003e\n\u003chr\u003e\n\u003cblockquote\u003e\n\u003cp\u003e본 내용은 한양대학교 컴퓨터소프트웨어학과 및 인공지능학과 백은옥 교수님의 강의자료을 바탕으로하여 작성되었습니다!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePS. 추가 문의사항 및 질문은 환영합니다. 그를 통해 저도 더 성장할 수 있을테니까요. :)\u003c/p\u003e\n\u003c/blockquote\u003e\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"relative\",\"children\":[[\"$\",\"article\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-10 not-prose border-b border-gray-100 dark:border-gray-800 pb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-4 text-sm text-gray-500 flex items-center space-x-2\",\"children\":[[[\"$\",\"$Le\",null,{\"href\":\"/category/proteomics\",\"className\":\"font-medium text-blue-600 hover:underline\",\"children\":\"proteomics\"}],[\"$\",\"span\",null,{\"children\":\"•\"}]],[\"$\",\"time\",null,{\"children\":\"$undefined\"}]]}],[\"$\",\"h1\",null,{\"className\":\"text-4xl font-extrabold tracking-tight text-gray-900 dark:text-white mb-4\",\"children\":\"[Proteomics] Peptide Identification - DB Search\"}]]}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$19\"}}]]}],\"$L1a\"]}]\n"])</script><script>self.__next_f.push([1,"1b:I[50718,[\"/_next/static/chunks/796e69ae18b2784c.js\",\"/_next/static/chunks/a8f82a9835eb887b.js\"],\"default\"]\n1a:[\"$\",\"$L1b\",null,{}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"1c:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"[Proteomics] Peptide Identification - DB Search\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Proteomics 수업 내용 정리 - PeptID_DBSearch\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L1c\",\"3\",{}]]\n8:null\n"])</script></body></html>